```html
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>皮卡丘的數學能量塊！- 同分母分數加減</title>
    <style>
        @font-face {
            font-family: 'PokemonSolid';
            src: url('path/to/PokemonSolid.ttf') format('truetype'); /* 假設您有這個字體 */
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'PikachuFont';
            src: url('path/to/PikachuFont.woff2') format('woff2'), url('path/to/PikachuFont.woff') format('woff'); /* 假設您有這個字體 */
            font-weight: normal;
            font-style: normal;
        }

        :root {
            --color-primary: #FFDA44; /* 皮卡丘黃 */
            --color-secondary: #E62C1A; /* 皮卡丘紅 */
            --color-dark: #000000; /* 黑色 */
            --color-light-yellow: #FFFACD; /* 淺黃 */
            --color-white: #FFFFFF;
            --color-gray: #808080;
        }

        body {
            font-family: 'PikachuFont', sans-serif; /* 使用皮卡丘風格字體 */
            margin: 0;
            padding: 0;
            background-color: var(--color-primary);
            color: var(--color-dark);
            line-height: 1.6;
            overflow-x: hidden; /* 防止水平滾動 */
        }

        .container {
            width: 95%;
            max-width: 1200px;
            margin: 20px auto;
            background-color: var(--color-light-yellow);
            border-radius: 20px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            padding: 30px;
            position: relative;
            overflow: hidden;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            padding: 20px 0;
        }

        header h1 {
            font-family: 'PokemonSolid', sans-serif; /* 標題使用更粗曠的字體 */
            font-size: 3em;
            color: var(--color-secondary);
            text-shadow: 3px 3px 0 var(--color-dark), 1px 1px 0 var(--color-dark), -1px -1px 0 var(--color-dark), 1px -1px 0 var(--color-dark), -1px 1px 0 var(--color-dark);
            margin: 0;
        }

        header p {
            font-size: 1.2em;
            color: var(--color-gray);
        }

        .pikachu-header-img {
            position: absolute;
            top: -20px;
            left: 10%;
            width: 150px;
            opacity: 0.7;
            animation: float 4s ease-in-out infinite;
        }

        .thunderbolt-img {
            position: absolute;
            top: 10px;
            right: 10%;
            width: 80px;
            opacity: 0.8;
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0px); }
        }

        section {
            margin-bottom: 50px;
            padding: 30px;
            background-color: var(--color-white);
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        section h2 {
            color: var(--color-secondary);
            font-size: 2em;
            text-align: center;
            margin-top: 0;
            position: relative;
            padding-bottom: 10px;
            border-bottom: 3px dashed var(--color-primary);
        }

        .section-icon {
            position: absolute;
            top: 15px;
            left: 15px;
            width: 50px;
            opacity: 0.7;
        }

        /* 視覺風格 - 寶可夢角色 */
        .pokemon-character {
            width: 120px;
            margin: 10px;
            vertical-align: middle;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        .pokemon-character:hover {
            transform: scale(1.1);
        }

        .pokemon-trainer {
            width: 100px;
            margin: 10px;
            vertical-align: middle;
        }

        /* 概念介紹 - 皮卡丘的能量塊 */
        .energy-block-intro {
            text-align: center;
        }

        .energy-block-wrapper {
            display: inline-block;
            margin: 20px;
            text-align: center;
        }

        .energy-block-img {
            width: 150px;
            height: 150px;
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5em;
            font-weight: bold;
            color: var(--color-dark);
            position: relative;
            margin: 0 auto 15px;
        }

        .energy-block-img.whole {
            background-image: url('path/to/whole_energy_block.png'); /* 預設能量塊圖案 */
        }
        .energy-block-img.eaten {
            background-image: url('path/to/eaten_energy_block.png'); /* 吃過的能量塊圖案 */
        }

        .energy-block-fraction {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--color-secondary);
        }

        .energy-block-animation {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }

        .energy-block-animation img {
            width: 100px;
            margin: 0 15px;
        }

        /* 互動練習 - 收集電擊能量 */
        .collection-area {
            text-align: center;
            margin-top: 30px;
        }

        .energy-slot {
            display: inline-block;
            width: 80px;
            height: 80px;
            border: 3px dashed var(--color-secondary);
            border-radius: 10px;
            margin: 5px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            cursor: grab; /* 拖曳手形 */
        }

        .energy-slot.filled {
            background-color: var(--color-primary);
            border-style: solid;
            cursor: default;
        }

        .energy-slot img {
            width: 50px;
            height: 50px;
            filter: drop-shadow(2px 2px 0px var(--color-dark));
        }

        .total-energy-bar {
            width: 70%;
            height: 50px;
            border: 3px solid var(--color-dark);
            border-radius: 25px;
            background-color: var(--color-light-yellow);
            margin: 20px auto;
            position: relative;
            display: flex;
            align-items: center;
            padding-left: 10px;
            font-size: 1.2em;
        }

        .total-energy-bar::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            background-image: url('path/to/lightning_icon.png'); /* 閃電圖標 */
            background-size: cover;
        }

        .fraction-input {
            width: 100px;
            height: 40px;
            font-size: 1.5em;
            text-align: center;
            border: 2px solid var(--color-secondary);
            border-radius: 10px;
            margin: 0 10px;
            color: var(--color-dark);
            background-color: var(--color-white);
        }

        .fraction-display {
            font-size: 1.8em;
            font-weight: bold;
            color: var(--color-secondary);
            margin-top: 15px;
            min-height: 40px; /* 確保空間 */
        }

        .progress-bar-container {
            width: 100%;
            background-color: #f3f3f3;
            border-radius: 10px;
            margin-top: 15px;
            overflow: hidden;
        }

        .progress-bar {
            height: 30px;
            background-color: var(--color-secondary);
            border-radius: 10px;
            text-align: center;
            line-height: 30px;
            color: white;
            font-weight: bold;
            transition: width 0.5s ease-in-out;
        }

        /* 互動練習 - 分享美味寶貝球 */
        .sharing-area {
            text-align: center;
            margin-top: 30px;
        }

        .baby-ball {
            width: 70px;
            height: 70px;
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            display: inline-block;
            margin: 5px;
            cursor: pointer;
            transition: transform 0.2s ease-in-out;
        }

        .baby-ball.remaining {
            background-image: url('path/to/red_pokeball.png'); /* 寶貝球圖案 */
        }
        .baby-ball.taken {
            opacity: 0.5;
            transform: scale(0.8);
        }

        .remaining-display {
            font-size: 1.8em;
            font-weight: bold;
            color: var(--color-dark);
            margin-top: 15px;
            min-height: 40px;
        }

        /* 應用題 - 冒險任務 */
        .adventure-task {
            text-align: center;
        }

        .task-card {
            background-color: var(--color-light-yellow);
            border: 3px dashed var(--color-primary);
            border-radius: 15px;
            padding: 20px;
            margin: 20px auto;
            width: 80%;
            max-width: 600px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .task-card p {
            font-size: 1.3em;
            color: var(--color-dark);
            margin-bottom: 20px;
        }

        .pokemon-sender {
            width: 80px;
            margin: 10px auto;
            display: block;
        }

        .difficulty-level {
            font-style: italic;
            color: var(--color-gray);
            font-size: 0.9em;
        }

        /* 練習與回饋 */
        .feedback-area {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            background-color: var(--color-light-yellow);
            border-radius: 15px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .feedback-message {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 15px;
            min-height: 50px; /* 確保空間 */
        }

        .feedback-image {
            width: 100px;
            height: 100px;
            margin: 10px auto;
            display: block;
        }

        .hint-animation {
            width: 200px;
            margin: 20px auto;
            display: block;
        }

        /* 遊戲化元素 */
        .gamification-panel {
            display: flex;
            justify-content: space-around;
            margin-top: 40px;
            padding: 20px;
            background-color: var(--color-light-yellow);
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .gamification-item {
            text-align: center;
        }

        .gamification-item img {
            width: 60px;
            height: 60px;
            margin-bottom: 10px;
        }

        .gamification-item span {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--color-secondary);
        }

        /* 按鈕 */
        .btn-pikachu {
            display: inline-block;
            background-color: var(--color-secondary);
            color: var(--color-white);
            padding: 15px 30px;
            font-size: 1.3em;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 0 var(--color-dark);
            text-decoration: none;
            margin: 10px;
        }

        .btn-pikachu:hover {
            background-color: var(--color-dark);
            box-shadow: 0 5px 0 var(--color-secondary);
            transform: translateY(2px);
        }

        .btn-pikachu:active {
            box-shadow: 0 0 0 var(--color-dark);
            transform: translateY(5px);
        }

        /* 響應式設計 */
        @media (max-width: 768px) {
            .container {
                width: 95%;
                padding: 20px;
            }
            header h1 {
                font-size: 2.5em;
            }
            .pikachu-header-img, .thunderbolt-img {
                width: 100px;
            }
            .pokemon-character {
                width: 80px;
            }
            .energy-block-img {
                width: 120px;
                height: 120px;
                font-size: 2em;
            }
            .total-energy-bar {
                width: 90%;
            }
            .fraction-input {
                width: 80px;
                height: 35px;
                font-size: 1.2em;
            }
            .gamification-panel {
                flex-direction: column;
            }
            .btn-pikachu {
                font-size: 1.1em;
                padding: 12px 25px;
            }
        }

        @media (max-width: 480px) {
            header h1 {
                font-size: 2em;
            }
            .pikachu-header-img, .thunderbolt-img {
                display: none; /* 小螢幕隱藏裝飾 */
            }
            .pokemon-character {
                width: 60px;
            }
            .energy-block-img {
                width: 100px;
                height: 100px;
                font-size: 1.8em;
            }
            .energy-block-animation img {
                width: 70px;
            }
            .btn-pikachu {
                width: 100%;
                margin: 5px 0;
                box-sizing: border-box; /* 確保寬度包含 padding */
            }
            .task-card {
                width: 95%;
                padding: 15px;
            }
        }

        /* 輔助樣式 */
        .text-center { text-align: center; }
        .mb-20 { margin-bottom: 20px; }
        .mt-30 { margin-top: 30px; }
        .pt-10 { padding-top: 10px; }
        .pb-10 { padding-bottom: 10px; }
        .d-flex { display: flex; }
        .justify-content-center { justify-content: center; }
        .align-items-center { align-items: center; }

    </style>
</head>
<body>

    <div class="container">

        <header>
            <img src="path/to/pikachu_flying.png" alt="Pikachu flying" class="pikachu-header-img">
            <img src="path/to/thunderbolt_pattern.png" alt="Thunderbolt pattern" class="thunderbolt-img">
            <h1>皮卡丘的數學能量塊！</h1>
            <p>Kevin 設計的同分母分數加減學習樂園</p>
        </header>

        <section id="intro">
            <img src="path/to/pikachu_thinking.gif" alt="Pikachu thinking" class="section-icon">
            <h2>皮卡丘的能量塊：分數是什麼？</h2>
            <div class="energy-block-intro">
                <p>皮卡丘最喜歡收集閃電能量塊了！想像一下，一個完整的能量塊，可以切成很多一樣大小的小塊，這就是「分母」告訴我們有多少小塊。</p>
                <p>皮卡丘現在有 8 塊同樣大小的能量塊（分母是 8），其中 3 塊是牠的（分子是 3）。所以，牠擁有的能量塊可以表示成 3/8 喔！</p>

                <div class="energy-block-animation">
                    <img src="path/to/energy_block_whole.png" alt="Whole energy block" class="pokemon-character">
                    <p style="font-size: 2em; color: var(--color-secondary); margin: 0 20px;">→</p>
                    <div class="energy-block-wrapper">
                        <div class="energy-block-img whole" style="background-image: url('path/to/energy_block_cut_8.png');">
                            <!-- 這裡需要動態顯示切分後的圖像 -->
                        </div>
                        <div class="energy-block-fraction">
                            3/8
                        </div>
                    </div>
                </div>
                <p>看看旁邊的皮卡丘，牠正在分享能量塊，這就是分數的開始！</p>
            </div>
        </section>

        <section id="addition">
            <img src="path/to/pikachu_charging.gif" alt="Pikachu charging" class="section-icon">
            <h2>收集電擊能量！(同分母分數加法)</h2>
            <p>皮卡丘正在收集電擊能量，牠先收集了 <span class="fraction-display"></span>，又收集了 <span class="fraction-display"></span>，總共收集了多少呢？</p>
            <p>當分母相同的時候，我們只要把分子加起來，分母就保持不變喔！就像把一樣大小的能量塊疊加一樣！</p>

            <div class="collection-area">
                <p>請將皮卡丘收集的能量塊拖曳到總能量槽中：</p>
                <div id="draggable-energy-slots" class="d-flex justify-content-center mb-20">
                    <!-- 這裡會動態生成能量塊 -->
                </div>

                <div class="total-energy-bar">
                    <span id="current-sum-display">0</span> / <span id="denominator-display"></span>
                </div>

                <p>計算結果是：</p>
                <div class="d-flex justify-content-center align-items-center mb-20">
                    <input type="number" id="addition-numerator-input" class="fraction-input" placeholder="分子">
                    <span class="fs-3 fw-bold mx-2">/</span>
                    <span id="addition-denominator-static" class="fs-3 fw-bold"></span>
                </div>
                <button id="check-addition-btn" class="btn-pikachu">檢查答案！</button>
                <div id="addition-feedback" class="feedback-area mt-30"></div>
            </div>
            <div class="gamification-challenge text-center mt-40">
                <p>每完成一關，皮卡丘就能學會新招式！</p>
                <img src="path/to/pikachu_happy.gif" alt="Pikachu happy" class="pokemon-character" style="width: 100px;">
            </div>
        </section>

        <section id="subtraction">
            <img src="path/to/pikachu_eating.gif" alt="Pikachu eating" class="section-icon">
            <h2>分享美味寶貝球！(同分母分數減法)</h2>
            <p>皮卡丘和牠的朋友們（例如：小火龍、傑尼龜）正在分享一個切好的美味寶貝球！</p>
            <p>如果一開始有 <span class="fraction-display"></span> 個寶貝球，皮卡丘吃掉了 <span class="fraction-display"></span> 個，還剩下多少呢？</p>
            <p>當分母相同的時候，我們只要用分子減去分子，分母一樣保持不變喔！</p>

            <div class="sharing-area">
                <p>請將被吃掉的寶貝球拖曳出去：</p>
                <div id="baby-balls-container" class="mb-20">
                    <!-- 這裡會動態生成寶貝球 -->
                </div>

                <p>還剩下：</p>
                <div id="remaining-fraction-display" class="remaining-display">
                    <!-- 顯示剩餘分數 -->
                </div>

                <p>計算結果是：</p>
                <div class="d-flex justify-content-center align-items-center mb-20">
                    <input type="number" id="subtraction-numerator-input" class="fraction-input" placeholder="分子">
                    <span class="fs-3 fw-bold mx-2">/</span>
                    <span id="subtraction-denominator-static" class="fs-3 fw-bold"></span>
                </div>
                <button id="check-subtraction-btn" class="btn-pikachu">檢查答案！</button>
                <div id="subtraction-feedback" class="feedback-area mt-30"></div>
            </div>
            <div class="gamification-challenge text-center mt-40">
                <p>挑戰搶答，看看誰的計算速度最快！</p>
                <img src="path/to/squirtle_happy.gif" alt="Squirtle happy" class="pokemon-character" style="width: 100px;">
            </div>
        </section>

        <section id="application">
            <img src="path/to/pikachu_adventuring.gif" alt="Pikachu adventuring" class="section-icon">
            <h2>冒險任務！(應用題)</h2>
            <p>準備好迎接冒險挑戰了嗎？皮卡丘需要你的數學幫助來完成任務！</p>

            <div id="task-cards-container">
                <!-- 這裡會動態生成應用題卡片 -->
                <div class="task-card">
                    <img src="path/to/charmander_posing.png" alt="Charmander" class="pokemon-sender">
                    <p>小火龍在後山找到了 5/10 罐的莓果，又在河邊找到了 3/10 罐的莓果，請問牠總共找到了幾分之幾的莓果？</p>
                    <p class="difficulty-level">難度：★☆☆</p>
                    <div class="d-flex justify-content-center align-items-center mb-20">
                        <input type="number" class="fraction-input" placeholder="分子"> / <span class="fs-3 fw-bold">10</span>
                    </div>
                    <button class="btn-pikachu">提交答案</button>
                </div>

                <div class="task-card">
                    <img src="path/to/bulbasaur_ready.png" alt="Bulbasaur" class="pokemon-sender">
                    <p>妙蛙種原本有 9/12 瓶的生命藥水，在冒險中不小心用掉了 2/12 瓶，還剩下幾分之幾的藥水？</p>
                    <p class="difficulty-level">難度：★★☆</p>
                    <div class="d-flex justify-content-center align-items-center mb-20">
                        <input type="number" class="fraction-input" placeholder="分子"> / <span class="fs-3 fw-bold">12</span>
                    </div>
                    <button class="btn-pikachu">提交答案</button>
                </div>
                <!-- 更多應用題卡片... -->
            </div>
            <div class="feedback-area mt-30">
                <p class="feedback-message">記得仔細閱讀題目，並用同分母分數加減法來解決喔！</p>
            </div>
        </section>

        <section id="gamification">
            <img src="path/to/pikachu_star.png" alt="Pikachu star" class="section-icon">
            <h2>冒險者的獎勵！(遊戲化元素)</h2>
            <div class="gamification-panel">
                <div class="gamification-item">
                    <img src="path/to/score_icon.png" alt="Score icon">
                    <span>積分：<span id="player-score">0</span></span>
                </div>
                <div class="gamification-item">
                    <img src="path/to/badge_master.png" alt="Badge icon">
                    <span>徽章：<span id="badges-earned">0</span></span>
                </div>
                <div class="gamification-item">
                    <img src="path/to/leaderboard_icon.png" alt="Leaderboard icon">
                    <span>排行榜</span>
                </div>
            </div>
            <div class="text-center mt-30">
                <p>收集積分，解鎖更多寶可夢圖案和背景音樂！</p>
                <p>獲得「分數大師」或「計算神手」等徽章，證明你的數學實力！</p>
                <button class="btn-pikachu">查看獎勵</button>
            </div>
        </section>

        <footer>
            <p class="text-center">Kevin 網頁設計 &copy; 2026 | 參考資料：<a href="https://www.mathsisfun.com/definitions/fraction.html" target="_blank">MathsIsFun - Fractions</a> | <a href="https://www.pokemon.com/" target="_blank">Pokemon Official</a></p>
        </footer>

    </div>

    <!-- JavaScript 引入 -->
    <script>
        // 假設這是 Pikachu's Math Adventure 的 JavaScript 檔案
        // 這裡會包含所有互動邏輯、題目生成、回饋處理等

        document.addEventListener('DOMContentLoaded', () => {
            console.log("Kevin's Pikachu Math Adventure loaded!");

            // --- 範例：簡單的題目生成與檢查 (需要更完善的邏輯) ---

            let currentAdditionProblem = {};
            let currentSubtractionProblem = {};
            let player_score = 0;
            const scoreDisplay = document.getElementById('player-score');

            // 產生分數 (分子 < 分母)
            function generateFraction(maxDenominator) {
                const denominator = Math.floor(Math.random() * (maxDenominator - 2)) + 3; // 分母至少3
                const numerator = Math.floor(Math.random() * (denominator - 1)) + 1;    // 分子至少1，且小於分母
                return { numerator, denominator };
            }

            // 更新分數顯示
            function updateScore(points) {
                player_score += points;
                scoreDisplay.textContent = player_score;
            }

            // --- 加法單元 ---
            const additionNumeratorInput = document.getElementById('addition-numerator-input');
            const additionDenominatorStatic = document.getElementById('addition-denominator-static');
            const checkAdditionBtn = document.getElementById('check-addition-btn');
            const additionFeedback = document.getElementById('addition-feedback');
            const currentSumDisplay = document.getElementById('current-sum-display');
            const denominatorDisplay = document.getElementById('denominator-display');
            const draggableEnergySlots = document.getElementById('draggable-energy-slots');

            function loadAdditionProblem() {
                currentAdditionProblem = {
                    fraction1: generateFraction(10),
                    fraction2: generateFraction(10)
                };
                // 確保分母相同
                currentAdditionProblem.fraction2.denominator = currentAdditionProblem.fraction1.denominator;

                const frac1 = currentAdditionProblem.fraction1;
                const frac2 = currentAdditionProblem.fraction2;

                document.querySelector('#addition p:nth-of-type(1)').innerHTML = `皮卡丘正在收集電擊能量，牠先收集了 <span class="fraction-display">${frac1.numerator}/${frac1.denominator}</span>，又收集了 <span class="fraction-display">${frac2.numerator}/${frac2.denominator}</span>，總共收集了多少呢？`;
                additionDenominatorStatic.textContent = frac1.denominator;
                denominatorDisplay.textContent = frac1.denominator;
                currentSumDisplay.textContent = '0';
                additionNumeratorInput.value = '';
                additionFeedback.innerHTML = '';

                // 產生可拖曳的能量塊
                draggableEnergySlots.innerHTML = '';
                let totalNumerator = 0;
                for (let i = 0; i < frac1.numerator; i++) {
                    const slot = document.createElement('div');
                    slot.classList.add('energy-slot');
                    slot.innerHTML = '<img src="path/to/lightning_energy.png" alt="Energy">'; // 閃電能量圖案
                    slot.setAttribute('draggable', 'true');
                    slot.dataset.value = 'energy';
                    draggableEnergySlots.appendChild(slot);
                    totalNumerator++;
                }
                for (let i = 0; i < frac2.numerator; i++) {
                    const slot = document.createElement('div');
                    slot.classList.add('energy-slot');
                    slot.innerHTML = '<img src="path/to/lightning_energy.png" alt="Energy">'; // 閃電能量圖案
                    slot.setAttribute('draggable', 'true');
                    slot.dataset.value = 'energy';
                    draggableEnergySlots.appendChild(slot);
                    totalNumerator++;
                }

                // 拖曳事件 (簡化版)
                let droppedCount = 0;
                let targetBar = document.querySelector('.total-energy-bar');

                draggableEnergySlots.querySelectorAll('.energy-slot').forEach(slot => {
                    slot.addEventListener('dragstart', (e) => {
                        e.dataTransfer.setData('text/plain', slot.dataset.value);
                        setTimeout(() => slot.style.display = 'none', 0); // 暫時隱藏
                    });
                });

                targetBar.addEventListener('dragover', (e) => {
                    e.preventDefault(); // 允許放置
                });

                targetBar.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const data = e.dataTransfer.getData('text/plain');
                    if (data === 'energy') {
                        droppedCount++;
                        currentSumDisplay.textContent = droppedCount;
                        if (droppedCount >= totalNumerator) {
                            // 視覺化提示已放滿
                            targetBar.style.backgroundColor = '#f0e68c'; // 稍微變黃
                        }
                        // 顯示正確的能量塊在槽裡
                        const slot = document.createElement('div');
                        slot.classList.add('energy-slot', 'filled');
                        slot.innerHTML = '<img src="path/to/lightning_energy.png" alt="Energy">';
                        slot.style.cursor = 'default';
                        targetBar.appendChild(slot); // 簡化：直接添加到bar裡，實際應有預設槽位
                    }
                });
            }

            checkAdditionBtn.addEventListener('click', () => {
                const submittedNumerator = parseInt(additionNumeratorInput.value);
                const correctDenominator = currentAdditionProblem.fraction1.denominator;
                const correctNumerator = currentAdditionProblem.fraction1.numerator + currentAdditionProblem.fraction2.numerator;

                if (submittedNumerator === correctNumerator && correctDenominator === currentAdditionProblem.fraction1.denominator) {
                    additionFeedback.innerHTML = '<p class="feedback-message" style="color: green;">Pika Pika! 答對了！你真是個數學小天才！</p><img src="path/to/pikachu_thumbs_up.gif" alt="Pikachu thumbs up" class="feedback-image">';
                    updateScore(10); // 答對加分
                    setTimeout(loadAdditionProblem, 2000); // 載入下一題
                } else {
                    additionFeedback.innerHTML = `<p class="feedback-message" style="color: red;">哎呀！好像有點不對喔。正確答案是 ${correctNumerator}/${correctDenominator}。</p><img src="path/to/pikachu_sad.gif" alt="Pikachu sad" class="feedback-image">`;
                    // 顯示錯誤提示或示範
                    const hintDiv = document.createElement('div');
                    hintDiv.innerHTML = `
                        <p>讓我來幫你看看！把 ${currentAdditionProblem.fraction1.numerator}/${currentAdditionProblem.fraction1.denominator} 和 ${currentAdditionProblem.fraction2.numerator}/${currentAdditionProblem.fraction2.denominator} 加起來，就像這樣：</p>
                        <img src="path/to/fraction_addition_hint.gif" alt="Fraction addition hint" class="hint-animation">
                    `;
                    additionFeedback.appendChild(hintDiv);
                }
            });

            // --- 減法單元 ---
            const subtractionNumeratorInput = document.getElementById('subtraction-numerator-input');
            const subtractionDenominatorStatic = document.getElementById('subtraction-denominator-static');
            const checkSubtractionBtn = document.getElementById('check-subtraction-btn');
            const subtractionFeedback = document.getElementById('subtraction-feedback');
            const remainingFractionDisplay = document.getElementById('remaining-fraction-display');
            const babyBallsContainer = document.getElementById('baby-balls-container');

            function loadSubtractionProblem() {
                currentSubtractionProblem = {
                    initial: generateFraction(10),
                    taken: {}
                };
                // 確保吃的比原有的少
                currentSubtractionProblem.taken = generateFraction(currentSubtractionProblem.initial.numerator);
                currentSubtractionProblem.taken.denominator = currentSubtractionProblem.initial.denominator;

                const initial = currentSubtractionProblem.initial;
                const taken = currentSubtractionProblem.taken;

                document.querySelector('#subtraction p:nth-of-type(2)').innerHTML = `皮卡丘和牠的朋友們（例如：小火龍、傑尼龜）正在分享一個切好的美味寶貝球！如果一開始有 <span class="fraction-display">${initial.numerator}/${initial.denominator}</span> 個寶貝球，皮卡丘吃掉了 <span class="fraction-display">${taken.numerator}/${taken.denominator}</span> 個，還剩下多少呢？`;
                subtractionDenominatorStatic.textContent = initial.denominator;
                remainingFractionDisplay.textContent = `${initial.numerator}/${initial.denominator}`; // 初始狀態
                subtractionNumeratorInput.value = '';
                subtractionFeedback.innerHTML = '';

                // 產生寶貝球
                babyBallsContainer.innerHTML = '';
                for (let i = 0; i < initial.numerator; i++) {
                    const ball = document.createElement('div');
                    ball.classList.add('baby-ball', 'remaining');
                    ball.dataset.index = i;
                    ball.setAttribute('draggable', 'true');
                    babyBallsContainer.appendChild(ball);
                }

                // 拖曳事件
                let eatenCount = 0;
                let initialBalls = babyBallsContainer.querySelectorAll('.baby-ball.remaining');

                babyBallsContainer.querySelectorAll('.baby-ball.remaining').forEach(ball => {
                    ball.addEventListener('dragstart', (e) => {
                        e.dataTransfer.setData('text/plain', ball.dataset.index);
                        setTimeout(() => ball.style.display = 'none', 0);
                    });
                });

                // 放置目標 (可以是一個垃圾桶圖標或只是畫面下方)
                const dropTarget = document.body; // 簡化，實際應有明確的放置區域
                dropTarget.addEventListener('dragover', (e) => { e.preventDefault(); });
                dropTarget.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const index = e.dataTransfer.getData('text/plain');
                    const droppedBall = babyBallsContainer.querySelector(`.baby-ball[data-index="${index}"]`);

                    if (droppedBall && droppedBall.classList.contains('remaining')) {
                        eatenCount++;
                        droppedBall.classList.add('taken'); // 視覺化移除
                        droppedBall.style.display = 'none'; // 實際移除

                        const remainingNumerator = initial.numerator - eatenCount;
                        remainingFractionDisplay.textContent = `${remainingNumerator}/${initial.denominator}`;

                        if (eatenCount >= taken.numerator) {
                            // 提示已移除足夠數量
                            babyBallsContainer.style.border = '3px solid green';
                        }
                    }
                });
            }

            checkSubtractionBtn.addEventListener('click', () => {
                const submittedNumerator = parseInt(subtractionNumeratorInput.value);
                const correctDenominator = currentSubtractionProblem.initial.denominator;
                const correctNumerator = currentSubtractionProblem.initial.numerator - currentSubtractionProblem.taken.numerator;

                if (submittedNumerator === correctNumerator && correctDenominator === currentSubtractionProblem.initial.denominator) {
                    subtractionFeedback.innerHTML = '<p class="feedback-message" style="color: green;">Pika Pika! 算對了！太棒了！</p><img src="path/to/pikachu_dance.gif" alt="Pikachu dance" class="feedback-image">';
                    updateScore(10);
                    setTimeout(loadSubtractionProblem, 2000);
                } else {
                    subtractionFeedback.innerHTML = `<p class="feedback-message" style="color: red;">嗯... 好像還有點差距。正確答案是 ${correctNumerator}/${correctDenominator}。</p><img src="path/to/pikachu_confused.gif" alt="Pikachu confused" class="feedback-image">`;
                    // 顯示錯誤提示或示範
                     const hintDiv = document.createElement('div');
                    hintDiv.innerHTML = `
                        <p>還記得嗎？從 ${currentSubtractionProblem.initial.numerator}/${currentSubtractionProblem.initial.denominator} 裡面，拿走 ${currentSubtractionProblem.taken.numerator}/${currentSubtractionProblem.taken.denominator}，就像這樣：</p>
                        <img src="path/to/fraction_subtraction_hint.gif" alt="Fraction subtraction hint" class="hint-animation">
                    `;
                    subtractionFeedback.appendChild(hintDiv);
                }
            });

            // --- 應用題 (需要更複雜的題目生成和檢查邏輯) ---
            // 這裡僅為範例，實際需生成多個題目並有檢查機制

            // --- 初始化 ---
            loadAdditionProblem();
            loadSubtractionProblem();
            // loadApplicationProblems(); // 載入應用題
        });
    </script>

</body>
</html>
```